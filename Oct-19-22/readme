Cleaned how the code allocate memory on the device (GPU).
modified data structure for the code to support multiple simulations. 
